# DevOpsæœ€é©åŒ– - ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆã‚¬ã‚¤ãƒ‰

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€æœ€é©åŒ–ã•ã‚ŒãŸCI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®ä½¿ã„æ–¹ã‚’èª¬æ˜ã—ã¾ã™ã€‚

---

## ğŸš€ ã™ãã«ä½¿ãˆã‚‹æ©Ÿèƒ½

### 1. è‡ªå‹•ä¿®å¾©ãƒ«ãƒ¼ãƒ— v2ï¼ˆæ®µéšçš„æˆåŠŸåˆ¤å®šï¼‰

**æ”¹å–„ç‚¹**:
- ã‚¨ãƒ©ãƒ¼é‡å¤§åº¦åˆ¥ã®åˆ†é¡ï¼ˆCritical/Warningï¼‰
- æ®µéšçš„æˆåŠŸåˆ¤å®šï¼ˆSuccess/Partial Success/Improvedï¼‰
- ã‚¨ãƒ©ãƒ¼å‰Šæ¸›ç‡ã«ã‚ˆã‚‹æ—©æœŸçµ‚äº†

**ä½¿ã„æ–¹**:
```bash
# åŸºæœ¬å®Ÿè¡Œï¼ˆæœ€å¤§10ãƒ«ãƒ¼ãƒ—ï¼‰
python scripts/auto_error_repair_loop.py

# ãƒ«ãƒ¼ãƒ—å›æ•°ã‚’æŒ‡å®š
python scripts/auto_error_repair_loop.py --max-loops 5

# Issueç•ªå·ã‚’æŒ‡å®š
python scripts/auto_error_repair_loop.py --issue-number 123
```

**æˆåŠŸåŸºæº–**:
- âœ… **å®Œå…¨æˆåŠŸ**: ã‚¨ãƒ©ãƒ¼0å€‹
- âš ï¸ **éƒ¨åˆ†çš„æˆåŠŸ**: ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ã‚¨ãƒ©ãƒ¼0å€‹ã€è­¦å‘Šã®ã¿æ®‹å­˜
- ğŸ“ˆ **æ”¹å–„**: ã‚¨ãƒ©ãƒ¼æ•°ãŒ50%ä»¥ä¸Šæ¸›å°‘
- ğŸ”§ **è©¦è¡Œæ¸ˆã¿**: æœ€ä½é™ã®ä¿®å¾©ã‚’å®Ÿè¡Œ

### 2. Issueè‡ªå‹•ç®¡ç†

**æ©Ÿèƒ½**:
- 7æ—¥ä»¥ä¸Šå¤ã„Issueã‚’è‡ªå‹•ã‚¯ãƒ­ãƒ¼ã‚º
- é‡è¤‡Issueã®çµ±åˆ
- Issueæ•°ã®é–¾å€¤ç›£è¦–ï¼ˆ10å€‹è¶…ã§è­¦å‘Šï¼‰
- ä¿®å¾©æˆåŠŸæ™‚ã®è‡ªå‹•ã‚¯ãƒ­ãƒ¼ã‚º

**ä½¿ã„æ–¹**:
```bash
# ã™ã¹ã¦ã®ç®¡ç†ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œ
python scripts/issue_manager.py --all

# å€‹åˆ¥å®Ÿè¡Œ
python scripts/issue_manager.py --close-old 7
python scripts/issue_manager.py --consolidate-duplicates
python scripts/issue_manager.py --check-threshold 10
```

### 3. ç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆ

**æ©Ÿèƒ½**:
- ä¿®å¾©æˆåŠŸç‡ã®ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°
- é€£ç¶šå¤±æ•—ã®æ¤œçŸ¥
- ç•°å¸¸æ¤œçŸ¥ï¼ˆæˆåŠŸç‡ä½ä¸‹ã€ãƒ«ãƒ¼ãƒ—å›æ•°å¢—åŠ ï¼‰
- GitHub/Slacké€šçŸ¥

**ä½¿ã„æ–¹**:
```bash
# å…¨ç›£è¦–ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œ
python scripts/monitoring_alert.py --all

# Slacké€šçŸ¥ã‚ã‚Š
export SLACK_WEBHOOK_URL="https://hooks.slack.com/..."
python scripts/monitoring_alert.py --all --slack-webhook $SLACK_WEBHOOK_URL
```

---

## ğŸ“Š GitHub Actions Workflow

### è‡ªå‹•å®Ÿè¡Œã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

| Workflow | å®Ÿè¡Œé »åº¦ | èª¬æ˜ |
|----------|---------|------|
| `auto-error-detection-repair-v2.yml` | 30åˆ†ã”ã¨ | è‡ªå‹•ä¿®å¾©ãƒ«ãƒ¼ãƒ—å®Ÿè¡Œ |
| `issue-management.yml` | æ¯æ—¥0æ™‚ | Issueè‡ªå‹•ç®¡ç† |
| `monitoring.yml` | 6æ™‚é–“ã”ã¨ | CI/CDç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆ |

### æ‰‹å‹•å®Ÿè¡Œ

```bash
# è‡ªå‹•ä¿®å¾©ã‚’æ‰‹å‹•å®Ÿè¡Œ
gh workflow run "è‡ªå‹•ã‚¨ãƒ©ãƒ¼æ¤œçŸ¥ãƒ»ä¿®å¾©ãƒ«ãƒ¼ãƒ—ã‚·ã‚¹ãƒ†ãƒ  v2ï¼ˆæœ€é©åŒ–ç‰ˆï¼‰"

# Issueç®¡ç†ã‚’æ‰‹å‹•å®Ÿè¡Œ
gh workflow run "Issueè‡ªå‹•ç®¡ç†"

# ç›£è¦–ã‚’æ‰‹å‹•å®Ÿè¡Œ
gh workflow run "CI/CDç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆ"
```

---

## ğŸ” ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®ç¢ºèª

### 1. ä¿®å¾©ã‚µãƒãƒªãƒ¼ã®ç¢ºèª

```bash
# æœ€æ–°ã®ä¿®å¾©ã‚µãƒãƒªãƒ¼
cat repair_summary.json | jq .

# ä¸»è¦ãƒ¡ãƒˆãƒªã‚¯ã‚¹
jq '.final_status, .success_rate, .error_reduction_rate' repair_summary.json
```

### 2. Issueç®¡ç†ã‚µãƒãƒªãƒ¼ã®ç¢ºèª

```bash
cat issue_management_summary.json | jq .
```

### 3. ç›£è¦–ãƒ¬ãƒãƒ¼ãƒˆã®ç¢ºèª

```bash
cat monitoring_report.json | jq .

# ç•°å¸¸ã®ç¢ºèª
jq '.anomalies' monitoring_report.json
```

---

## âš™ï¸ ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### æˆåŠŸåŸºæº–ã®èª¿æ•´

`scripts/auto_error_repair_loop.py` ã®ä»¥ä¸‹ã®éƒ¨åˆ†ã‚’ç·¨é›†:

```python
# ã‚¨ãƒ©ãƒ¼å‰Šæ¸›ç‡ã®é–¾å€¤ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 50%ï¼‰
if reduction_rate >= 0.5:  # 0.7 ã«å¤‰æ›´ã™ã‚‹ã¨70%å‰Šæ¸›ãŒå¿…è¦
    return 'improved'

# æ—©æœŸçµ‚äº†ã®é–¾å€¤ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 30%ï¼‰
if current_error_count < self.initial_error_count * 0.3:  # 0.5 ã«å¤‰æ›´ã™ã‚‹ã¨50%
    logger.info("âœ… ã‚¨ãƒ©ãƒ¼æ•°ãŒå¤§å¹…ã«æ¸›å°‘ã—ã¾ã—ãŸã€‚ãƒ«ãƒ¼ãƒ—ã‚’çµ‚äº†ã—ã¾ã™")
    break
```

### Issueç®¡ç†ã®é–¾å€¤èª¿æ•´

```bash
# å¤ã„Issueã®åŸºæº–æ—¥æ•°ã‚’å¤‰æ›´
python scripts/issue_manager.py --close-old 14  # 14æ—¥ã«å¤‰æ›´

# Issueæ•°ã®é–¾å€¤ã‚’å¤‰æ›´
python scripts/issue_manager.py --check-threshold 20  # 20å€‹ã«å¤‰æ›´
```

### ç›£è¦–ã®é–¾å€¤èª¿æ•´

`scripts/monitoring_alert.py` ã®ä»¥ä¸‹ã®éƒ¨åˆ†ã‚’ç·¨é›†:

```python
# é€£ç¶šå¤±æ•—ã®é–¾å€¤ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 5å›ï¼‰
self.detect_continuous_failures(threshold=10)  # 10å›ã«å¤‰æ›´

# æˆåŠŸç‡ã®é–¾å€¤ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 60%ï¼‰
self.detect_low_success_rate(threshold=50.0)  # 50%ã«å¤‰æ›´

# ãƒ«ãƒ¼ãƒ—å›æ•°ã®é–¾å€¤ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 7å›ï¼‰
self.detect_high_loop_count(threshold=8)  # 8å›ã«å¤‰æ›´
```

---

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œ

#### 1. ã€ŒGITHUB_TOKEN ãŒã‚ã‚Šã¾ã›ã‚“ã€ã‚¨ãƒ©ãƒ¼

**è§£æ±ºç­–**:
```bash
export GITHUB_TOKEN="ghp_xxxxxxxxxxxxx"
# ã¾ãŸã¯
gh auth login
```

#### 2. WorkflowãŒå®Ÿè¡Œã•ã‚Œãªã„

**ç¢ºèªäº‹é …**:
- `.github/workflows/` é…ä¸‹ã«YAMLãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹ã‹
- YAMLã®æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ãŒãªã„ã‹
- æ¨©é™è¨­å®šãŒæ­£ã—ã„ã‹

```yaml
permissions:
  contents: write
  issues: write
```

#### 3. Issue ãŒè‡ªå‹•ã‚¯ãƒ­ãƒ¼ã‚ºã•ã‚Œãªã„

**ç¢ºèªäº‹é …**:
```bash
# Issueãƒ©ãƒ™ãƒ«ãŒæ­£ã—ã„ã‹ç¢ºèª
gh issue list --label "auto-repair"

# æ‰‹å‹•ã§ãƒ©ãƒ™ãƒ«ã‚’è¿½åŠ 
gh issue edit 123 --add-label "auto-repair"
```

---

## ğŸ“ˆ æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ

### ãƒ“ãƒ•ã‚©ãƒ¼/ã‚¢ãƒ•ã‚¿ãƒ¼

| æŒ‡æ¨™ | Before | After | æ”¹å–„ |
|------|--------|-------|------|
| ä¿®å¾©æˆåŠŸç‡ | 30% | 80%+ | +166% |
| ã‚ªãƒ¼ãƒ—ãƒ³Issueæ•° | 30å€‹ | 5å€‹ä»¥ä¸‹ | -83% |
| æ‰‹å‹•ä»‹å…¥/é€± | 10å› | 2å›ä»¥ä¸‹ | -80% |
| MTTR | 60åˆ† | 15åˆ†ä»¥ä¸‹ | -75% |

---

## ğŸ“š é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [DevOpsæ”¹å–„ãƒ¬ãƒãƒ¼ãƒˆ](./DEVOPS_IMPROVEMENTS.md) - è©³ç´°ãªæ”¹å–„å†…å®¹
- [ã‚·ã‚¹ãƒ†ãƒ ä»•æ§˜æ›¸](../../CLAUDE.md) - å…¨ä½“ä»•æ§˜
- [CI/CDè¨­å®š](../.github/workflows/) - Workflowè¨­å®š

---

## âœ… ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

åˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ™‚:

- [ ] Python 3.11+ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿
- [ ] `pip install -r requirements-dev.txt` å®Ÿè¡Œæ¸ˆã¿
- [ ] GitHub CLI (`gh`) ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿
- [ ] `gh auth login` ã§èªè¨¼æ¸ˆã¿
- [ ] ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å‹•ä½œç¢ºèªå®Œäº†
- [ ] Workflowã®å‹•ä½œç¢ºèªå®Œäº†

---

## ğŸ¯ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **1é€±é–“**: ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®åé›†ã¨è¦³å¯Ÿ
2. **2é€±é–“**: é–¾å€¤ã®å¾®èª¿æ•´
3. **1ãƒ¶æœˆ**: åŠ¹æœã®æ¸¬å®šã¨ãƒ¬ãƒãƒ¼ãƒˆ
4. **3ãƒ¶æœˆ**: æ›´ãªã‚‹æœ€é©åŒ–ã®æ¤œè¨

---

**è³ªå•ãƒ»ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯**: GitHub Issue ã§ãŠé¡˜ã„ã—ã¾ã™

**æœ€çµ‚æ›´æ–°**: 2025-11-12
